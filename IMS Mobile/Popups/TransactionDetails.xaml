<?xml version="1.0" encoding="utf-8" ?>
<toolkit:Popup
    x:Class="IMS_Mobile.Popups.TransactionDetails"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:Converters="clr-namespace:IMS_Mobile.Converters"
    xmlns:Models="clr-namespace:IMS_Mobile.MVVM.Models"
    xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
    Margin="0"
    Padding="0"
    BackgroundColor="White"
    CanBeDismissedByTappingOutsideOfPopup="True"
    HeightRequest="600">
    <toolkit:Popup.Resources>
        <Converters:DTSelector2 x:Key="dt" />
    </toolkit:Popup.Resources>
    <Grid
        Margin="0"
        Padding="0"
        RowDefinitions="Auto,Auto,*,Auto"
        RowSpacing="5">
        <!--  Header  -->
        <Grid Grid.Row="0" ColumnDefinitions="*,Auto">
            <VerticalStackLayout Grid.Column="0" Spacing="4">
                <Label StyleClass="SectionTitleStyle" Text="Transaction Details" />
                <Label
                    Margin="20,0,0,0"
                    StyleClass="SmallTextStyle"
                    Text="View all products in this transaction" />
            </VerticalStackLayout>

            <Button
                Grid.Column="1"
                Margin="0,10,10,0"
                BackgroundColor="Transparent"
                Clicked="OnCloseClicked"
                FontSize="20"
                HeightRequest="40"
                Text="âœ•"
                TextColor="Gray"
                VerticalOptions="Start"
                WidthRequest="40" />
        </Grid>

        <!--  Divider  -->
        <BoxView
            Grid.Row="1"
            BackgroundColor="#E0E0E0"
            HeightRequest="1" />

        <!--  Products List  -->
        <CollectionView
            Grid.Row="2"
            ItemTemplate="{StaticResource dt}"
            ItemsSource="{Binding Products}"
            VerticalScrollBarVisibility="Always">
            <CollectionView.ItemsLayout>
                <GridItemsLayout Orientation="Vertical" Span="1" />
            </CollectionView.ItemsLayout>

        </CollectionView>

        <!--  Footer  -->
        <Border
            Grid.Row="3"
            Padding="16,12"
            BackgroundColor="#F8F9FA"
            StrokeShape="RoundRectangle 8"
            StrokeThickness="0">
            <HorizontalStackLayout HorizontalOptions="Center" Spacing="8">
                <Label
                    FontSize="16"
                    Text="ðŸ“¦"
                    VerticalOptions="Center" />
                <Label
                    StyleClass="RegularTextStyle"
                    Text="{Binding Products.Count, StringFormat='{0} products'}"
                    VerticalOptions="Center" />
            </HorizontalStackLayout>
        </Border>
    </Grid>

</toolkit:Popup>